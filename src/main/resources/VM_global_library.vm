#macro(result_id $doc)result-$doc.getFieldValue('dataset_id')#end

#macro(f $f)$doc.getFieldValue($f)#end

#macro(field $f)
  #foreach($v in $doc.getFieldValues($f))
    $v
  #end
#end  

#macro(field_br $f)
  #foreach($v in $doc.getFieldValues($f))
    $v<br/>
  #end
#end  

#macro(field_ul $field)
  #set($values = $doc.getFieldValues($field))
  #if($values.size() > 1)
    <ul>
      #foreach($value in $values)
        <li>$value</li>
      #end
    </ul>
  #else
    $values.get(0)
  #end
#end

## escape method especially for href attribute
#macro(esc $txt)$txt.replaceAll("&", "&amp;").replaceAll("\"", "&quot;")#end

## return q param if defined
#macro(q)#if($request.originalParams.q)$request.originalParams.q#end#end

#macro(param $key)$request.params.getParams($key)#end

#macro(qurl)q=$!{esc.url("#q()")}#end
#macro(fqs_generic $fqs)#foreach($fq in $fqs)&fq=$esc.url($fq)#end#end
#macro(fqs)#fqs_generic($request.params.getParams('fq'))#end

#macro(lens)#qurl#fqs#end

#macro(url_for_lens)?#lens#end
#macro(url_for_start $start)#url_for_lens&start=$start#end

